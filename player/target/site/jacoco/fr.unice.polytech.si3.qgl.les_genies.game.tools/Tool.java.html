<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Tool.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">les_genies</a> &gt; <a href="index.source.html" class="el_package">fr.unice.polytech.si3.qgl.les_genies.game.tools</a> &gt; <span class="el_source">Tool.java</span></div><h1>Tool.java</h1><pre class="source lang-java linenums">package fr.unice.polytech.si3.qgl.les_genies.game.tools;

import fr.unice.polytech.si3.qgl.les_genies.game.shapes.Shape;
import fr.unice.polytech.si3.qgl.les_genies.game.visible_entities.Wind;
import java.awt.*;

public class Tool {

    Position shipPosition;

<span class="fc" id="L11">    public Tool(Position shipPosition) {</span>
<span class="fc" id="L12">        this.shipPosition = shipPosition;</span>
<span class="fc" id="L13">    }</span>
<span class="fc" id="L14">    public Tool() {}</span>

    /**
     * return the distance made by the boat and the new orientation in a Position object
     * @param rightOar number of oar use at the right of the boat
     * @param leftOar number of oar use at the left of the boat
     * @param totalOar number of oar on the boat
     * @return a Position that is corresponding to the move
     */
    Position distanceOar(int rightOar, int leftOar, int totalOar){
<span class="fc" id="L24">        double vitesse = oarSpeed(rightOar,leftOar,totalOar);</span>
<span class="fc" id="L25">        double rotation = oarAngle(rightOar,leftOar,totalOar);</span>

<span class="fc" id="L27">        return calculPosition(vitesse, rotation);</span>
    }

    /**
     * return the distance made by the boat and the new orientation in a Position object
     * @param rightOar number of oar use at the right of the boat
     * @param leftOar number of oar use at the left of the boat
     * @param totalOar number of oar on the boat
     * @param angleRudder the angle to turn with the rudder in radian
     * @return a Position that is corresponding to the move
     */
    Position distanceOarAndRudder(int rightOar, int leftOar, int totalOar, double angleRudder){
<span class="fc" id="L39">        double vitesse = oarSpeed(rightOar,leftOar,totalOar);</span>
<span class="fc" id="L40">        double rotation = oarAngle(rightOar,leftOar,totalOar) + angleRudder;</span>

<span class="fc" id="L42">        return calculPosition(vitesse, rotation);</span>
    }

    /**
     * return the distance made by the boat and the new orientation in a Position object
     * @param rightOar number of oar use at the right of the boat
     * @param leftOar number of oar use at the left of the boat
     * @param totalOar number of oar on the boat
     * @param angleRudder the angle to turn with the rudder in radian
     * @param sailOpen number of sail open
     * @param nbSail number of sail on the ship
     * @param wind object wind that has the strength and the orientation of the wind
     * @return a Position that is corresponding to the move
     */
    public Position distanceOarAndRudderAndSail(int rightOar, int leftOar, int totalOar, double angleRudder, int sailOpen, int nbSail, Wind wind){
<span class="fc" id="L57">        double vitesse = oarSpeed(rightOar,leftOar,totalOar) + sailSpeed(sailOpen,nbSail,wind,shipPosition.getOrientation());</span>
<span class="fc" id="L58">        double rotation = oarAngle(rightOar,leftOar,totalOar) + angleRudder;</span>

<span class="fc" id="L60">        return calculPosition(vitesse, rotation);</span>
    }

    /**
     * Calcul the relative position with the speed and rotation asked
     * @param vitesse speed of the boat
     * @param rotation angle to turn
     * @return a Position that is corresponding to the move
     */
    Position calculPosition(double vitesse, double rotation){
<span class="fc" id="L70">        Position newPosition = new Position(shipPosition.getX(),shipPosition.getY(),shipPosition.getOrientation());</span>
<span class="fc" id="L71">        double angle = shipPosition.getOrientation();</span>

<span class="fc" id="L73">        int cut = 10000;</span>
<span class="fc bfc" id="L74" title="All 2 branches covered.">        for(int i = 0; i &lt; cut; i++){</span>
<span class="fc" id="L75">            newPosition.setOrientation((newPosition.getOrientation()+rotation/ cut));</span>
<span class="fc" id="L76">            newPosition.setX(newPosition.getX()+(vitesse/ cut)*Math.cos(angle));</span>
<span class="fc" id="L77">            newPosition.setY(newPosition.getY()+(vitesse/ cut)*Math.sin(angle));</span>
<span class="fc" id="L78">            angle+=rotation/ cut;</span>
        }
<span class="fc" id="L80">        return newPosition;</span>
    }

    /**
     * give the angle between 2 orientation
     * @param a first orientation
     * @param b second orientation
     * @return an angle in rad
     */
    double angleBetween(double a, double b){
<span class="fc" id="L90">        return a-b;</span>
    }

    /**
     * Calcul the angle made by Oar
     * @param rightOar number of oar used at the right of the boat
     * @param leftOar number of oar used at the left of the boat
     * @param totalOar number of oar on the boat
     * @return the angle made
     */
    double oarAngle(int rightOar, int leftOar, int totalOar){
<span class="fc" id="L101">        return Math.PI*(rightOar-leftOar)/totalOar;</span>
    }

    /**
     * Calcul the speed made by Oar
     * @param rightOar number of oar used at the right of the boat
     * @param leftOar number of oar used at the left of the boat
     * @param totalOar number of oar on the boat
     * @return the speed made
     */
    double oarSpeed(int rightOar, int leftOar, int totalOar){
<span class="fc" id="L112">        return 165.0 * (rightOar+leftOar)/totalOar;</span>
    }

    /**
     * Calcul the speed made by sail
     * @param sailOpen number of sail open
     * @param nbSail number of sail on the boat
     * @param wind Object wind
     * @param shipOrientation orientation of the ship
     * @return the speed made
     */
    double sailSpeed(int sailOpen, int nbSail, Wind wind, double shipOrientation){
<span class="pc bpc" id="L124" title="1 of 2 branches missed.">        if(nbSail==0) return 0;</span>
<span class="fc bfc" id="L125" title="All 2 branches covered.">        if(wind == null) {</span>
<span class="fc" id="L126">            return 0.0;</span>
        }
<span class="fc" id="L128">        return (double)sailOpen/nbSail*wind.getStrength()*Math.cos(angleBetween(shipOrientation,wind.getOrientation()));</span>
    }

    private Polygon rotatePoints(Position position, Shape shape, int[] xs, int[] ys, int size){
        double temp;
<span class="fc" id="L133">        double angle = position.getOrientation() + shape.getOrientation();</span>

<span class="fc bfc" id="L135" title="All 2 branches covered.">        for (int i = 0; i&lt;size;i++){</span>
<span class="fc" id="L136">            temp = xs[i]*Math.cos(angle) - ys[i]*Math.sin(angle);</span>
<span class="fc" id="L137">            ys[i] = (int)(xs[i]*Math.sin(angle) + ys[i]*Math.cos(angle) + position.getY());</span>
<span class="fc" id="L138">            xs[i] = (int)(temp + position.getX());</span>
        }
<span class="fc" id="L140">        return new Polygon(xs,ys, size);</span>
    }


    private Polygon calculRectangle(Shape shape, Position position){
<span class="fc" id="L145">        int size = 4;</span>
<span class="fc" id="L146">        int[] xs = new int[size];</span>
<span class="fc" id="L147">        int[] ys = new int[size];</span>

<span class="fc" id="L149">        xs[0] = (int)shape.getHeight()/2;</span>
<span class="fc" id="L150">        ys[0] = (int)shape.getWidth()/2;</span>

<span class="fc" id="L152">        xs[1] = (int)-shape.getHeight()/2;</span>
<span class="fc" id="L153">        ys[1] = (int)shape.getWidth()/2;</span>

<span class="fc" id="L155">        xs[2] = (int)-shape.getHeight()/2;</span>
<span class="fc" id="L156">        ys[2] = (int)-shape.getWidth()/2;</span>

<span class="fc" id="L158">        xs[3] = (int)shape.getHeight()/2;</span>
<span class="fc" id="L159">        ys[3] = (int)-shape.getWidth()/2;</span>

<span class="fc" id="L161">        return rotatePoints(position, shape, xs, ys, size);</span>
    }

    private Polygon calculPolygone(Shape shape, Position position){
<span class="fc" id="L165">        int size = shape.getVertices().length;</span>

<span class="fc" id="L167">        int[] xs = new int[size];</span>
<span class="fc" id="L168">        int[] ys = new int[size];</span>

<span class="fc bfc" id="L170" title="All 2 branches covered.">        for(int i = 0 ; i &lt; size ; i++){</span>
<span class="fc" id="L171">            xs[i] = (int) shape.getVertices()[i].getX();</span>
<span class="fc" id="L172">            ys[i] = (int) shape.getVertices()[i].getY();</span>
        }

<span class="fc" id="L175">        return rotatePoints(position, shape, xs, ys, size);</span>
    }

    public Polygon createRectangle(Shape shape, Position position) {
<span class="pc bpc" id="L179" title="1 of 2 branches missed.">        if(shape.getType().equals(Constants.RECTANGLE)) return calculRectangle(shape, position);</span>
<span class="nc" id="L180">        return null;</span>
    }

    public Polygon createPolygone(Shape shape, Position position){
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">        if(shape.getType().equals(Constants.POLYGONE)) return calculPolygone(shape, position);</span>
<span class="nc" id="L185">        return null;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>